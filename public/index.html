<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@700;800;900&display=swap" rel="stylesheet">
  <style>
    /* --- Base Styles & Fonts --- */
    :root { --vh: 1vh; }
    html { scroll-behavior: smooth; }
    body {
      font-family: 'Cairo', sans-serif;
      background: #0d1117; color: #e5e7eb; line-height: 1.6;
      display: flex; flex-direction: column; height: 100vh; height: 100dvh;
    }
    h1,h2,h3,h4,h5,h6 { font-family: 'Tajawal', sans-serif; margin-bottom: 1rem; }
    p { margin-bottom: 1.5rem; }

    /* --- Core Components & Gradients --- */
    .text-gradient {
      background: linear-gradient(90deg, #60a5fa, #8b5cf6, #ec4899);
      -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;
    }
    .btn-gradient {
      background: linear-gradient(90deg, #60a5fa, #8b5cf6);
      transition: transform .3s, box-shadow .3s;
      box-shadow: 0 4px 10px rgba(0,0,0,.2); position: relative; z-index: 10;
    }
    .btn-gradient:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,.3); }

    /* --- Sticky areas --- */
    #main-header, #dashboard-header {
      position: sticky; top: 0; z-index: 50;
      background: rgba(13, 17, 23, 0.85);
      backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid #30363d;
    }
    #scroll-wrapper { flex-grow: 1; overflow-y: auto; }
    #main-footer { position: sticky; bottom: 0; z-index: 50; background: #0d1117; border-top: 1px solid #30363d; }

    /* --- Hero --- */
    .hero-section {
      background: url('https://images.unsplash.com/photo-1516117172878-fd2dc7981503?q=80&w=2070&auto=format&fit=crop') no-repeat center center/cover;
      position: relative; padding: 8rem 0; overflow: hidden;
    }
    .hero-overlay { background-color: rgba(13,17,23,.8); position: absolute; inset: 0; }

    /* --- Cards & Robots --- */
    .card { background:#161b22; border:1px solid #30363d; transition:.3s; box-shadow:0 4px 8px rgba(0,0,0,.2); }
    .card:hover { transform: translateY(-10px); box-shadow:0 15px 25px rgba(0,0,0,.4); background:#1f242b; }
    .robot-card {
      display:flex; flex-direction:column; align-items:center; text-align:center;
      background:#161b22; padding:1.5rem; border-radius:1rem; border:1px solid #30363d;
      box-shadow:0 4px 8px rgba(0,0,0,.2); transition:transform .3s; position:relative; overflow:hidden; cursor:pointer;
    }
    .robot-card:hover { transform: translateY(-10px); }
    .robot-circle {
      width:120px; height:120px; border-radius:50%;
      background:linear-gradient(to right, #60a5fa, #8b5cf6);
      display:flex; justify-content:center; align-items:center; position:relative; overflow:hidden;
    }
    .robot-image { width:100%; height:100%; object-fit:cover; transition:transform .3s; }
    .robot-card:hover .robot-image { transform:scale(1.1); }

    /* --- FAQ --- */
    .faq-item { background:#161b22; padding:1.5rem; border-radius:.75rem; border:1px solid #30363d; cursor:pointer; transition:background-color .3s; }
    .faq-item:hover { background:#1f242b; }
    .faq-question { display:flex; justify-content:space-between; align-items:center; }
    .faq-answer { max-height:0; overflow:hidden; transition:max-height .5s ease-in-out; }
    .faq-item.active .faq-answer { max-height:200px; padding-top: 1rem; }
    .faq-icon { transform:rotate(0); transition:transform .3s; }
    .faq-item.active .faq-icon { transform:rotate(180deg); }

    /* --- Pricing & Badges --- */
    .discount-badge {
      background: linear-gradient(90deg, #60a5fa, #8b5cf6, #ec4899);
      color:#fff; padding:.5rem 1.5rem; border-radius:9999px; font-weight:bold; font-size:1.125rem;
      position:absolute; top:-1.5rem; right:-1.5rem; transform:rotate(45deg); transform-origin:bottom left; box-shadow:0 4px 10px rgba(0,0,0,.2);
    }
    .price-box { position:relative; display:inline-block; }
    .icon-svg { width:48px; height:48px; color:#10b981; margin-bottom:1rem; }

    /* --- Modal --- */
    .modal { display:none; position:fixed; z-index:100; inset:0; overflow:auto; background:rgba(0,0,0,.7); backdrop-filter:blur(5px); justify-content:center; align-items:center; }
    .modal-content { background:#161b22; padding:2rem; border:1px solid #30363d; width:90%; max-width:400px; border-radius:1rem; box-shadow:0 10px 25px rgba(0,0,0,.5); animation:fadeIn .3s; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(-20px); } to { opacity:1; transform:translateY(0); } }
    .close-btn { color:#aaa; float:left; font-size:28px; font-weight:bold; }
    .close-btn:hover, .close-btn:focus { color:#fff; text-decoration:none; cursor:pointer; }

    /* --- Chat bubbles --- */
    .chat-message { padding:.75rem 1rem; border-radius:.75rem; max-width:85%; word-break:break-word; white-space:pre-wrap; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
    .user-message { background:#056056; color:#fff; align-self:flex-end; text-align:right; border-bottom-right-radius: .25rem; }
    .ai-message { background:#202c33; color:#fff; align-self:flex-start; text-align:left; border-bottom-left-radius: .25rem; }

    /* --- Mobile & keyboard --- */
    html, body { overscroll-behavior-y:contain; }
    * { -webkit-tap-highlight-color: transparent; }
    #robot-chat-messages, #setup-chat-messages { -webkit-overflow-scrolling: touch; scroll-behavior: smooth; overscroll-behavior: contain; padding-bottom: 88px; }
    #robot-chat-interface, #setup-chat-interface {
      display: none; position: fixed; inset:0; background:#0d1117; z-index:90;
      flex-direction:column; justify-content:space-between; height: 100vh; height: 100dvh; height: calc(var(--vh) * 100);
      padding-bottom: env(safe-area-inset-bottom, 0px);
    }
    .chat-input-bar { position: sticky; bottom: 0; left: 0; right: 0; background: rgba(13,17,23,.9); backdrop-filter: blur(6px); border-top: 1px solid #30363d; z-index: 5; padding: .5rem; }

    #scroll-to-bottom {
      position: fixed; inset-inline-end: 1rem;
      inset-block-end: calc(6rem + env(safe-area-inset-bottom, 0px));
      background: #8b5cf6; color:#fff; border-radius:9999px;
      padding:.6rem 1rem; font-weight:700;
      box-shadow: 0 10px 20px rgba(0,0,0,.35);
      display:none; z-index:60; border: 1px solid rgba(255,255,255,0.2);
    }
    #scroll-to-bottom.show { display:inline-flex; align-items:center; gap:.5rem; }
  </style>

  <!-- Ø­Ø±Ø§Ø³ LocalStorage Ø§Ù„Ø¢Ù…Ù†ÙˆÙ† (ÙŠÙØ³ØªØ®Ø¯Ù…Ø§Ù† Ù„Ø§Ø­Ù‚Ø§Ù‹) -->
  <script>
    function safeGet(key, fallback = null) {
      try {
        const raw = localStorage.getItem(key);
        if (raw === null || raw === undefined || raw === "undefined") return fallback;
        return JSON.parse(raw);
      } catch (_) { return fallback; }
    }
    function safeSet(key, value) {
      try { localStorage.setItem(key, JSON.stringify(value)); } catch(_) {}
    }
  </script>
</head>
<body class="antialiased">

  <!-- Header -->
  <header class="p-6" id="main-header">
    <div class="container mx-auto flex justify-between items-center">
      <h1 class="text-3xl font-bold text-white">ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ</h1>
      <a href="#" id="login-btn" class="btn-gradient text-white px-6 py-2 rounded-full font-semibold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
    </div>
  </header>

  <!-- Scrollable wrapper -->
  <div id="scroll-wrapper">
    <!-- Main Landing Page Content -->
    <main id="main-content">
      <section class="hero-section text-center relative flex items-center justify-center">
        <div class="hero-overlay"></div>
        <div class="container mx-auto px-4 relative z-10 py-16">
          <h2 class="text-5xl md:text-7xl font-extrabold leading-tight mb-4 text-white">
            <span class="text-gradient">Ø£Ù†Ø¬Ø² Ø£ÙƒØ«Ø±</span> Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ
          </h2>
          <p class="text-xl md:text-2xl text-gray-300 mb-8 max-w-3xl mx-auto">
            Ù†Ù‚Ø¯Ù… Ù„Ùƒ ÙØ±ÙŠÙ‚Ø§Ù‹ Ù…ØªØ®ØµØµØ§Ù‹ Ù…Ù† 12 Ù…Ø³Ø§Ø¹Ø¯Ø§Ù‹ØŒ ÙƒÙ„ Ù…Ù†Ù‡Ù… Ø¬Ø§Ù‡Ø² Ù„Ø¥Ù†Ø¬Ø§Ø² Ù…Ù‡Ù…Ø© Ù…Ø­Ø¯Ø¯Ø© Ø¨Ø¯Ù‚Ø© ÙˆÙƒÙØ§Ø¡Ø©.
          </p>
          <a href="#" class="btn-gradient text-white text-lg px-8 py-4 rounded-full">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</a>
        </div>
      </section>

      <!-- Pricing Section -->
      <section class="py-20 bg-gray-900 text-center">
        <div class="container mx-auto px-4">
          <h3 class="text-4xl font-bold mb-4 text-white">Ø¹Ø±Ø¶ Ø­ØµØ±ÙŠ Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©</h3>
          <p class="text-xl text-gray-400 mb-8 max-w-2xl mx-auto">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„ ÙˆØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯ Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø¨Ø³Ø¹Ø± Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠ ÙŠØ¯ÙØ¹ Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©.</p>
          <div class="bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-700 max-w-lg mx-auto relative overflow-hidden">
            <div class="discount-badge">Ø®ØµÙ… Ù©Ù %</div>
            <div class="relative z-10 flex flex-col items-center">
              <p class="text-5xl font-extrabold text-white mb-2">
                <span class="text-2xl line-through text-gray-500">200$</span>
                <span class="text-gradient text-6xl">39$</span>
              </p>
              <p class="text-gray-400 mb-6">Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©</p>
              <a href="#" class="btn-gradient text-white text-lg px-8 py-4 rounded-full">Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†</a>
            </div>
          </div>
        </div>
      </section>

      <!-- What You Get -->
      <section class="py-20">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">Ù…Ø§ Ø§Ù„Ø°ÙŠ Ø³ØªØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡ØŸ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-3xl mx-auto">Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø°ÙŠ ØªØ¯ÙØ¹Ù‡ Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø²Ø§ÙŠØ§ Ù„Ø§ Ø­ØµØ± Ù„Ù‡Ø§.</p>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-700 text-center">
              <svg class="icon-svg mx-auto" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
              <h4 class="text-2xl font-bold mb-2 text-white">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø§Ù„Ù€12</h4>
              <p class="text-gray-400">ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„ Ø¥Ù„Ù‰ ÙƒÙ„ Ù…Ø³Ø§Ø¹Ø¯ Ù…Ù† Ù…Ø³Ø§Ø¹Ø¯ÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù€12.</p>
            </div>
            <div class="bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-700 text-center">
              <svg class="icon-svg mx-auto" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
              <h4 class="text-2xl font-bold mb-2 text-white">ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©</h4>
              <p class="text-gray-400">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ù…Ø¬Ø§Ù†Ø§Ù‹.</p>
            </div>
            <div class="bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-700 text-center">
              <svg class="icon-svg mx-auto" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
              <h4 class="text-2xl font-bold text-white">Ø­Ù„ Ù…ØªÙƒØ§Ù…Ù„</h4>
              <p class="text-gray-400">ÙˆØ¯Ø§Ø¹Ø§Ù‹ Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§ØªØŒ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ Ù‡Ùˆ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Features -->
      <section class="py-20 bg-gray-900">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">Ù„Ù…Ø§Ø°Ø§ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠØŸ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-2xl mx-auto">
            Ù„Ø£Ù†Ù†Ø§ Ù†Ø¤Ù…Ù† Ø¨Ø£Ù† Ø§Ù„ØªØ®ØµØµ ÙŠÙˆÙ„Ø¯ Ø§Ù„ÙƒÙØ§Ø¡Ø©. Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø£Ø¯Ø§Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ù†Ù‚Ø¯Ù… Ù„Ùƒ ÙØ±ÙŠÙ‚Ø§Ù‹ Ù…ØªÙƒØ§Ù…Ù„Ø§Ù‹ Ù„Ø¥Ø¯Ø§Ø±Ø© ÙƒÙ„ Ø¬Ø§Ù†Ø¨ Ù…Ù† Ø¬ÙˆØ§Ù†Ø¨ Ø¹Ù…Ù„Ùƒ.
          </p>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="card p-8">
              <div class="text-5xl mb-4 text-gradient">âœ¨</div>
              <h4 class="text-2xl font-bold mb-2 text-white">ØªØ®ØµØµ Ù„Ø§ Ù…Ø«ÙŠÙ„ Ù„Ù‡</h4>
              <p class="text-gray-400">ÙƒÙ„ Ù…Ø³Ø§Ø¹Ø¯ Ù…ØµÙ…Ù… Ø®ØµÙŠØµØ§Ù‹ Ù„Ø¥ØªÙ‚Ø§Ù† Ù…Ù‡Ù…ØªÙ‡ØŒ Ù…Ù† Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø¥Ù„Ù‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„.</p>
            </div>
            <div class="card p-8">
              <div class="text-5xl mb-4 text-gradient">ğŸš€</div>
              <h4 class="text-2xl font-bold mb-2 text-white">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ø³Ø±Ø¹Ø©</h4>
              <p class="text-gray-400">Ù‚Ù„Ù„ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚ ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªÙƒØ±Ø±Ø© ÙˆØ±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø± ÙˆØ§Ù„Ù†Ù…Ùˆ.</p>
            </div>
            <div class="card p-8">
              <div class="text-5xl mb-4 text-gradient">ğŸ”—</div>
              <h4 class="text-2xl font-bold text-white">Ø­Ù„ Ù…ØªÙƒØ§Ù…Ù„</h4>
              <p class="text-gray-400">ÙˆØ¯Ø§Ø¹Ø§Ù‹ Ù„Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§ØªØŒ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ Ù‡Ùˆ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- How it works -->
      <section class="py-20">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">ÙƒÙŠÙ ÙŠØ¹Ù…Ù„ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠØŸ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-3xl mx-auto">Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ø³ÙŠØ·Ø© ÙˆÙ…Ø¨Ø§Ø´Ø±Ø©ØŒ Ù…ØµÙ…Ù…Ø© Ù„ØªÙˆÙÙŠØ± Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯.</p>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="flex flex-col items-center">
              <div class="text-6xl text-gradient mb-4">1</div>
              <h4 class="text-2xl font-bold mb-2 text-white">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</h4>
              <p class="text-gray-400">ØªØµÙØ­ Ù‚Ø§Ø¦Ù…ØªÙ†Ø§ ÙˆØ§Ø®ØªØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙŠ ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ù…Ù‡Ù…ØªÙƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.</p>
            </div>
            <div class="flex flex-col items-center">
              <div class="text-6xl text-gradient mb-4">2</div>
              <h4 class="text-2xl font-bold mb-2 text-white">Ø£Ø¹Ø·Ù‡ Ù…Ù‡Ù…ØªÙƒ</h4>
              <p class="text-gray-400">Ø£Ø¯Ø®Ù„ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©ØŒ ÙˆØ³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ±.</p>
            </div>
            <div class="flex flex-col items-center">
              <div class="text-6xl text-gradient mb-4">3</div>
              <h4 class="text-2xl font-bold mb-2 text-white">Ø§Ø³ØªÙ„Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h4>
              <p class="text-gray-400">Ø³ÙˆÙ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù†ØªØ§Ø¦Ø¬ Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© ÙÙŠ ÙˆÙ‚Øª Ù‚ÙŠØ§Ø³ÙŠ.</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Robots -->
      <section class="py-20 bg-gray-900">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ÙØ±ÙŠÙ‚Ùƒ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-3xl mx-auto">12 Ù…Ø³Ø§Ø¹Ø¯Ø§Ù‹ Ø°ÙƒÙŠØ§Ù‹ØŒ ÙƒÙ„ Ù…Ù†Ù‡Ù… ÙŠÙ…Ø«Ù„ Ø®Ø¨Ø±Ø© Ù…Ø­Ø¯Ø¯Ø©.</p>
          <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6" id="robots-grid"></div>
        </div>
      </section>

      <!-- Testimonials -->
      <section class="py-20">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">Ù…Ø§Ø°Ø§ ÙŠÙ‚ÙˆÙ„ Ø¹Ù…Ù„Ø§Ø¤Ù†Ø§ØŸ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-2xl mx-auto">Ù‚ØµØµ Ù†Ø¬Ø§Ø­ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ù…Ù† Ø£Ø´Ø®Ø§Øµ ÙˆØ´Ø±ÙƒØ§Øª Ø­ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù….</p>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="card p-8 text-left">
              <p class="text-lg text-gray-300 mb-4">"ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ ØºÙŠØ± Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ø´Ø±ÙƒØªÙ†Ø§."</p>
              <p class="font-bold text-white">- Ø£Ø­Ù…Ø¯ØŒ Ø±Ø§Ø¦Ø¯ Ø£Ø¹Ù…Ø§Ù„</p>
            </div>
            <div class="card p-8 text-left">
              <p class="text-lg text-gray-300 mb-4">"Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙÙ‘Ø± Ø³Ø§Ø¹Ø§Øª ÙˆØ²Ø§Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª."</p>
              <p class="font-bold text-white">- Ø³Ø§Ø±Ø©ØŒ Ù…Ø¯ÙŠØ±Ø© ØªØ³ÙˆÙŠÙ‚</p>
            </div>
            <div class="card p-8 text-left">
              <p class="text-lg text-gray-300 mb-4">"ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ø± Ø£Ø³Ù‡Ù„ Ø¨ÙƒØ«ÙŠØ± Ù…Ø¹ Ù…ÙŠÙ†Ø§."</p>
              <p class="font-bold text-white">- Ø®Ø§Ù„Ø¯ØŒ Ù…Ø­Ù„Ù„ Ø¨ÙŠØ§Ù†Ø§Øª</p>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQ -->
      <section class="py-20 bg-gray-900">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-3xl mx-auto">Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ù‹Ø§.</p>
          <div class="space-y-4 max-w-3xl mx-auto text-left">
            <div class="faq-item">
              <div class="faq-question">
                <h5 class="font-bold text-white">Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø³Ø§Ø¹Ø¯ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚ØªØŸ</h5>
                <svg class="faq-icon w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
              </div>
              <div class="faq-answer text-gray-400"><p>Ù†Ø¹Ù…ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠ Ø¹Ø¯Ø¯ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† Ø¨Ø§Ù„ØªÙˆØ§Ø²ÙŠâ€”ÙƒÙ„ Ù…Ø³Ø§Ø¹Ø¯ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ‚Ù„.</p></div>
            </div>
            <div class="faq-item">
              <div class="faq-question">
                <h5 class="font-bold text-white">Ù‡Ù„ ØªØªÙˆÙØ± Ù†Ø³Ø®Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©ØŸ</h5>
                <svg class="faq-icon w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
              </div>
              <div class="faq-answer text-gray-400"><p>Ù„Ø§ØŒ Ø§Ù„Ø£Ø¯Ø§Ø© ØªÙØ¨Ø§Ø¹ Ø¨Ø³Ø¹Ø± Ø­ØµØ±ÙŠ Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ù…Ø¯Ù‰ Ø§Ù„Ø­ÙŠØ§Ø©.</p></div>
            </div>
            <div class="faq-item">
              <div class="faq-question">
                <h5 class="font-bold text-white">Ù…Ø§ Ù‡ÙŠ ØªÙƒÙ„ÙØ© Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŸ</h5>
                <svg class="faq-icon w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
              </div>
              <div class="faq-answer text-gray-400"><p>Ù„Ø§ Ø§Ø´ØªØ±Ø§Ùƒ Ø´Ù‡Ø±ÙŠâ€”Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·.</p></div>
            </div>
          </div>
        </div>
      </section>

      <!-- CTA -->
      <section class="py-20 bg-gray-800 text-center">
        <div class="container mx-auto px-4">
          <h3 class="text-4xl font-bold text-white mb-4">Ø¬Ø§Ù‡Ø² Ù„ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù…Ø²ÙŠØ¯ØŸ</h3>
          <p class="text-xl text-gray-400 mb-8">Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ ÙˆØ§Ø¨Ø¯Ø£ ÙÙŠ Ø¥Ù†Ø¬Ø§Ø² Ù…Ù‡Ø§Ù…Ùƒ Ø¨ÙƒÙØ§Ø¡Ø© ØºÙŠØ± Ù…Ø³Ø¨ÙˆÙ‚Ø©.</p>
          <a href="#" class="btn-gradient text-white text-lg px-8 py-4 rounded-full">Ø§Ø´ØªØ±Ù Ø§Ù„Ø¢Ù†</a>
        </div>
      </section>
    </main>

    <!-- Dashboard -->
    <div id="dashboard-container" class="hidden">
      <header class="p-6" id="dashboard-header">
        <div class="container mx-auto flex justify-between items-center">
          <h1 class="text-3xl font-bold text-white">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
          <div class="flex space-x-4 space-x-reverse">
            <a href="#" id="profile-btn" class="btn-gradient text-white px-6 py-2 rounded-full font-semibold">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</a>
            <a href="#" id="logout-btn" class="btn-gradient text-white px-6 py-2 rounded-full font-semibold">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
          </div>
        </div>
      </header>
      <section class="py-12">
        <div class="container mx-auto px-4 text-center">
          <h3 class="text-4xl font-bold mb-4 text-white">Ø§Ø®ØªØ± Ù…Ø³Ø§Ø¹Ø¯Ùƒ</h3>
          <p class="text-xl text-gray-400 mb-12 max-w-3xl mx-auto">Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø£ÙŠ Ù…Ø³Ø§Ø¹Ø¯ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ù…Ù‡Ø§Ù…Ùƒ.</p>
          <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6" id="robot-list"></div>
        </div>
      </section>

      <!-- Previous Chats -->
      <section class="py-12 bg-gray-900">
        <div class="container mx-auto px-4">
          <h3 class="text-4xl font-bold mb-6 text-white text-center">Ù…Ø­Ø§Ø¯Ø«Ø§ØªÙƒ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
          <div id="conversations-list" class="space-y-4"></div>
        </div>
      </section>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-900 text-center py-6" id="main-footer">
    <p class="text-gray-500">&copy; 2023 ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
  </footer>

  <!-- MODALS & CHAT INTERFACES -->

  <!-- Login Modal -->
  <div id="login-modal" class="modal">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h4 class="text-2xl font-bold text-white mb-6 text-center">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h4>
      <div class="mb-4">
        <label for="username" class="block text-gray-400 mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
        <input type="text" id="username" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-purple-500" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      </div>
      <div class="mb-6">
        <label for="password" class="block text-gray-400 mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
        <input type="password" id="password" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-700 text-white focus:outline-none focus:border-purple-500" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      </div>
      <button id="submit-login" class="btn-gradient w-full text-white py-3 rounded-full font-bold">Ø¯Ø®ÙˆÙ„</button>
      <p id="login-message" class="mt-4 text-center font-bold"></p>
    </div>
  </div>

  <!-- Setup Chat Interface -->
  <div id="setup-chat-interface" class="flex">
    <div class="flex-grow overflow-y-auto p-4 flex flex-col gap-4" id="setup-chat-messages"></div>
    <div class="flex gap-2 p-2 border-t border-gray-700 chat-input-bar">
      <input type="text" id="setup-chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§..." class="flex-grow p-3 rounded-full bg-gray-800 border border-gray-700 text-white focus:outline-none">
      <button id="setup-chat-send-btn" class="bg-blue-600 text-white p-3 rounded-full font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>

  <!-- Profile Section -->
  <div id="profile-section" class="hidden fixed top-0 left-0 w-full h-full bg-[#0d1117] z-[90] flex-col overflow-y-auto">
    <div class="flex items-center justify-between p-4 bg-gray-800 border-b border-gray-700 sticky top-0">
      <button id="back-to-dashboard-from-profile-btn" class="text-white text-2xl">&larr;</button>
      <h4 class="text-xl font-bold text-white flex-grow text-center">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h4>
      <span class="w-6 h-6"></span>
    </div>
    <div class="container mx-auto px-4 py-8">
      <h3 class="text-3xl font-bold text-white mb-6">Ø¨ÙŠØ§Ù†Ø§ØªÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
      <div id="basic-data" class="bg-gray-800 p-6 rounded-lg mb-8 border border-gray-700"></div>

      <h3 class="text-3xl font-bold text-white mb-6">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙŠ ØªØ¹Ù„Ù…Ù‡Ø§ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
      <div id="learned-data" class="bg-gray-800 p-6 rounded-lg border border-gray-700">
        <p class="text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ù…Ø³Ø§Ø¹Ø¯ÙŠÙƒ!</p>
      </div>
    </div>
  </div>

  <!-- Robot Chat Interface -->
  <div id="robot-chat-interface" class="flex">
    <div class="flex items-center justify-between p-4 bg-gray-800 border-b border-gray-700 sticky top-0">
      <button id="back-to-dashboard-btn" class="text-white text-2xl">&larr;</button>
      <h4 id="robot-chat-header" class="text-xl font-bold text-white flex-grow text-center"></h4>
      <span class="w-6 h-6"></span>
    </div>
    <div id="robot-chat-messages" class="flex-grow overflow-y-auto p-4 flex flex-col gap-4"></div>
    <div class="flex gap-2 p-2 border-t border-gray-700 items-center chat-input-bar">
      <label for="file-upload" class="cursor-pointer p-2 rounded-full hover:bg-gray-700">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-gray-400 hover:text-white">
          <path stroke-linecap="round" stroke-linejoin="round" d="M18.375 12.739l-7.693 7.693a4.5 4.5 0 01-6.364-6.364l10.94-10.94A3 3 0 1119.5 7.372L8.552 18.32m.009-.01l-.01.01m5.699-9.941l-7.81 7.81a1.5 1.5 0 002.122 2.122l7.81-7.81-2.12-2.12z" />
        </svg>
        <input type="file" id="file-upload" class="hidden">
      </label>
      <input type="text" id="robot-chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." class="flex-grow p-3 rounded-full bg-gray-800 border border-gray-700 text-white focus:outline-none">
      <button id="robot-chat-send-btn" class="bg-blue-600 text-white p-3 rounded-full font-bold">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>

  <!-- Scroll to Bottom Button -->
  <button id="scroll-to-bottom" aria-label="Ø§Ø°Ù‡Ø¨ Ù„Ø¢Ø®Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„">â¬‡ï¸ Ø¢Ø®Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„</button>

  <script>
    /* =============== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±ÙˆØ¨ÙˆØªØ§Øª =============== */
    const robots = [
      { name: "Ø£Ù„ÙØ§ (Alfa)",   specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ", img: "https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=800&auto=format&fit=crop" },
      { name: "ÙÙŠØ²ÙŠ (Vizi)",   specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª", img: "https://images.unsplash.com/photo-1551836022-d5d88e9218df?q=80&w=800&auto=format&fit=crop" },
      { name: "ÙƒÙˆØ±ØªÙƒØ³ (Cortex)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø§Ù„ÙŠ", img: "https://images.unsplash.com/photo-1554224155-8d04cb21cd6c?q=80&w=800&auto=format&fit=crop" },
      { name: "Ù„ÙŠÙƒØ³ (Lex)",   specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", img: "https://images.unsplash.com/photo-1525182008055-f88b95ff7980?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø£ÙˆÙƒØªÙˆ (Octo)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", img: "https://images.unsplash.com/photo-1563986768494-4dee2763ff3f?q=80&w=800&auto=format&fit=crop" },
      { name: "Ù…ÙŠÙ†Ø§ (Mina)",   specialization: "Ù…Ø³Ø§Ø¹Ø¯ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", img: "https://images.unsplash.com/photo-1556761175-4b46a572b786?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø¨ÙˆÙ„Øª (Bolt)",   specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹", img: "https://images.unsplash.com/photo-1519389950473-47ba0277781c?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø±ÙŠÙƒØ³ (Rex)",     specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©", img: "https://images.unsplash.com/photo-1554224154-22dec7ec8818?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø¨Ø§Ø¯ÙŠ (Buddy)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©", img: "https://images.unsplash.com/photo-1520975922325-24baf8635f3b?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø±ÙˆÙØ± (Rover)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø¹Ù„Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡", img: "https://images.unsplash.com/photo-1521737604893-d14cc237f11d?q=80&w=800&auto=format&fit=crop" },
      { name: "ÙØ§Ù„ÙˆØ± (Valor)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©", img: "https://images.unsplash.com/photo-1512295767273-ac109ac3acfa?q=80&w=800&auto=format&fit=crop" },
      { name: "Ø²ÙŠÙ†ÙŠØ« (Zenith)", specialization: "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±", img: "https://images.unsplash.com/photo-1504384308090-c894fdcc538d?q=80&w=800&auto=format&fit=crop" },
    ];

    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => item.addEventListener('click', () => item.classList.toggle('active')));

    // UI elements
    const loginBtn = document.getElementById('login-btn');
    const loginModal = document.getElementById('login-modal');
    const closeModal = document.querySelector('.close-btn');
    const submitLogin = document.getElementById('submit-login');
    const usernameInput = document.getElementById('username');
    const passwordInput = document.getElementById('password');
    const loginMessage = document.getElementById('login-message');
    const mainContent = document.getElementById('main-content');
    const mainHeader = document.getElementById('main-header');
    const scrollWrapper = document.getElementById('scroll-wrapper');
    const mainFooter = document.getElementById('main-footer');

    // Setup Chat
    const setupChatInterface = document.getElementById('setup-chat-interface');
    const setupChatMessages = document.getElementById('setup-chat-messages');
    const setupChatInput = document.getElementById('setup-chat-input');
    const setupChatSendBtn = document.getElementById('setup-chat-send-btn');

    // Dashboard
    const dashboardContainer = document.getElementById('dashboard-container');
    const robotListContainer = document.getElementById('robot-list');
    const conversationsListContainer = document.getElementById('conversations-list');
    const profileBtn = document.getElementById('profile-btn');
    const logoutBtn = document.getElementById('logout-btn');

    // Profile
    const profileSection = document.getElementById('profile-section');
    const backToDashboardFromProfileBtn = document.getElementById('back-to-dashboard-from-profile-btn');
    const basicDataContainer = document.getElementById('basic-data');
    const learnedDataContainer = document.getElementById('learned-data');

    // Robot Chat
    const robotChatInterface = document.getElementById('robot-chat-interface');
    const robotChatHeader = document.getElementById('robot-chat-header');
    const robotChatMessages = document.getElementById('robot-chat-messages');
    const robotChatInput = document.getElementById('robot-chat-input');
    const robotChatSendBtn = document.getElementById('robot-chat-send-btn');
    const backToDashboardBtn = document.getElementById('back-to-dashboard-btn');
    const fileUploadInput = document.getElementById('file-upload');

    // State
    let setupChatState = 0;
    let companyData = {};
    let currentRobot = null;
    let robotChatState = {};
    let aiLearnedData = safeGet('aiLearnedData', {});

    const setupPrompts = [
      { id: 'name', text: "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø°ÙƒÙŠ. Ù‚Ø¨Ù„ Ø£Ù† Ù†Ø¨Ø¯Ø£ØŒ Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø´Ø±ÙƒØªÙƒØŸ" },
      { id: 'industry', text: "Ø´ÙƒØ±Ø§Ù‹. ÙˆÙ…Ø§ Ù‡Ùˆ Ù…Ø¬Ø§Ù„ Ø¹Ù…Ù„ Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØŸ (Ù…Ø«Ù„Ø§Ù‹: Ø§Ù„ØªØ¬Ø§Ø±Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©ØŒ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§)" },
      { id: 'size', text: "ÙÙ‡Ù…Øª. ÙˆÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙŠ Ø´Ø±ÙƒØªÙƒØŸ" },
      { id: 'audience', text: "ØªÙ…Ø§Ù…. Ù…Ù† Ù‡Ùˆ Ø¬Ù…Ù‡ÙˆØ±ÙƒÙ… Ø§Ù„Ù…Ø³ØªÙ‡Ø¯ÙØŸ (Ù…Ø«Ù„Ø§Ù‹: Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ØµØºÙŠØ±Ø©ØŒ Ø§Ù„Ø´Ø¨Ø§Ø¨ØŒ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø§Øª)" },
      { id: 'goals', text: "Ø±Ø§Ø¦Ø¹. Ø£Ø®ÙŠØ±Ø§Ù‹ØŒ Ù…Ø§ Ù‡ÙŠ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù…Ù† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¯ÙˆØ§ØªÙ†Ø§ØŸ (Ù…Ø«Ù„Ø§Ù‹: Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§ØªØŒ ØªØ­Ø³ÙŠÙ† Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ØŒ Ø§Ù„ØªÙˆØ³Ø¹ ÙÙŠ Ø³ÙˆÙ‚ Ø¬Ø¯ÙŠØ¯)" }
    ];

    // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ù…Ø­Ø§Ø¯Ø«Ø©
    function addMessage(chatContainer, text, sender) {
      const messageElement = document.createElement('div');
      messageElement.classList.add('chat-message', `${sender}-message`);
      messageElement.textContent = text;
      chatContainer.appendChild(messageElement);
    }

    /* --- Landing & Login --- */
    loginBtn.addEventListener('click', (e) => { e.preventDefault(); loginModal.style.display = 'flex'; });
    closeModal.addEventListener('click', () => { loginModal.style.display = 'none'; });
    window.addEventListener('click', (e) => { if (e.target === loginModal) loginModal.style.display = 'none'; });

    submitLogin.addEventListener('click', () => {
      const username = usernameInput.value;
      const password = passwordInput.value;
      if (username === 'Aiagent' && password === '2222') {
        loginMessage.textContent = 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!'; loginMessage.style.color = '#10b981';
        setTimeout(() => {
          loginModal.style.display = 'none';
          const company = safeGet('companyData', null);
          if (company && typeof company === 'object' && Object.keys(company).length) { showDashboard(); }
          else { startSetupChat(); }
        }, 800);
      } else {
        loginMessage.textContent = 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.'; loginMessage.style.color = '#ef4444';
      }
    });

    /* --- Setup Chat --- */
    function startSetupChat() {
      mainContent.classList.add('hidden');
      mainHeader.classList.add('hidden');
      scrollWrapper.classList.add('hidden');
      mainFooter.classList.add('hidden');
      setupChatInterface.style.display = 'flex';
      addMessage(setupChatMessages, setupPrompts[setupChatState].text, 'ai');
    }
    setupChatSendBtn.addEventListener('click', handleSetupChatInput);
    setupChatInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') handleSetupChatInput(); });

    function handleSetupChatInput() {
      const userMessage = setupChatInput.value.trim();
      if (userMessage === '') return;
      addMessage(setupChatMessages, userMessage, 'user');
      const currentPromptId = setupPrompts[setupChatState].id;
      companyData[currentPromptId] = userMessage;
      setupChatInput.value = '';
      setupChatState++;
      setTimeout(() => {
        if (setupChatState < setupPrompts.length) {
          addMessage(setupChatMessages, setupPrompts[setupChatState].text, 'ai');
        } else {
          addMessage(setupChatMessages, "Ù…Ù…ØªØ§Ø²! Ù„Ù‚Ø¯ Ø§ÙƒØªÙ…Ù„ Ù…Ù„ÙÙƒ Ø¨Ù†Ø¬Ø§Ø­. ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø¯ÙˆØ§ØªÙƒ.", 'ai');
          safeSet('companyData', companyData);
          setTimeout(() => {
            addMessage(setupChatMessages, "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒÙŠ!", 'ai');
            setupChatInterface.style.display = 'none'; showDashboard();
          }, 1200);
        }
      }, 600);
    }

    /* --- Dashboard --- */
    function showDashboard() {
      mainContent.classList.add('hidden');
      scrollWrapper.classList.remove('hidden');
      mainFooter.classList.remove('hidden');
      mainHeader.classList.remove('hidden');
      dashboardContainer.classList.remove('hidden');
      profileSection.classList.add('hidden');
      robotChatInterface.style.display = 'none';
      setupChatInterface.style.display = 'none';
      renderRobotList(); renderConversationsList();
    }

    function renderRobotList() {
      robotListContainer.innerHTML = '';
      robots.forEach(robot => {
        const card = document.createElement('div');
        card.className = 'robot-card';
        card.dataset.name = robot.name;
        card.innerHTML = `
          <div class="robot-circle">
            <img loading="lazy" src="${robot.img}" alt="Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø±ÙˆØ¨ÙˆØª ${robot.name}" class="robot-image"/>
          </div>
          <h4 class="font-bold mt-4 text-white">${robot.name}</h4>
          <p class="text-sm text-gray-400 mt-2">${robot.specialization}</p>
        `;
        card.addEventListener('click', () => startRobotChat(robot.name));
        robotListContainer.appendChild(card);
      });
    }

    function renderConversationsList() {
      conversationsListContainer.innerHTML = '';
      let hasConversations = false;
      robots.forEach(robot => {
        const conversation = safeGet(`conversation_${robot.name}`, []);
        if (Array.isArray(conversation) && conversation.length > 0) {
          hasConversations = true;
          const listItem = document.createElement('div');
          listItem.className = 'bg-gray-800 p-4 rounded-lg cursor-pointer hover:bg-gray-700 transition-colors';
          listItem.textContent = `Ù…Ø­Ø§Ø¯Ø«Ø© Ø³Ø§Ø¨Ù‚Ø© Ù…Ø¹ ${robot.name}`;
          listItem.addEventListener('click', () => startRobotChat(robot.name));
          conversationsListContainer.appendChild(listItem);
        }
      });
      if (!hasConversations) {
        conversationsListContainer.innerHTML = `<p class="text-center text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø³Ø§Ø¨Ù‚Ø©. Ø§Ø®ØªØ± Ù…Ø³Ø§Ø¹Ø¯Ø§Ù‹ Ù„Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©!</p>`;
      }
    }

    /* --- Profile --- */
    profileBtn.addEventListener('click', (e) => {
      e.preventDefault();
      scrollWrapper.classList.add('hidden'); mainFooter.classList.add('hidden'); profileSection.classList.remove('hidden'); updateProfileSection();
    });
    backToDashboardFromProfileBtn.addEventListener('click', () => {
      profileSection.classList.add('hidden'); scrollWrapper.classList.remove('hidden'); mainFooter.classList.remove('hidden');
    });

    function updateProfileSection() {
      const basicData = safeGet('companyData', {});
      const learnedData = safeGet('aiLearnedData', {});
      basicDataContainer.innerHTML = `
        <p class="text-gray-300 mb-2"><b>Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©:</b> ${basicData.name || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
        <p class="text-gray-300 mb-2"><b>Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„:</b> ${basicData.industry || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
        <p class="text-gray-300 mb-2"><b>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù:</b> ${basicData.goals || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</p>
      `;
      learnedDataContainer.innerHTML = '';
      const learnedKeys = Object.keys(learnedData || {});
      if (learnedKeys.length > 0) {
        learnedKeys.forEach(key => { learnedDataContainer.innerHTML += `<p class="text-gray-300 mb-2"><b>${key}:</b> ${learnedData[key]}</p>`; });
      } else {
        learnedDataContainer.innerHTML = `<p class="text-gray-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†. Ø§Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ù…Ø³Ø§Ø¹Ø¯ÙŠÙƒ!</p>`;
      }
    }

    /* --- Seed Prompts --- */
    const robotPrompts = {
      "Ø£Ù„ÙØ§ (Alfa)":   [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø£Ù„ÙØ§ (ØªØ³ÙˆÙŠÙ‚). Ø­Ø¯ÙÙ‘Ø¯ Ù‡Ø¯Ù Ø§Ù„Ø­Ù…Ù„Ø© (Ù…Ø¨ÙŠØ¹Ø§Øª/ÙˆØ¹ÙŠ/Ø¹Ù…Ù„Ø§Ø¡ Ø¬Ø¯Ø¯) + Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙˆØ§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆØ§Ù„Ø²Ù…Ù† Ù„Ù†ØµÙ…Ù… Ù…Ø³Ø§Ø±Ù‹Ø§ Ø³Ø±ÙŠØ¹Ù‹Ø§.' }],
      "ÙÙŠØ²ÙŠ (Vizi)":   [{ role: 'ai', text: 'Ø£Ù†Ø§ ÙÙŠØ²ÙŠ (Ù…Ø¨ÙŠØ¹Ø§Øª). Ø£Ø±Ø³Ù„ Ù…Ù†ØªØ¬Ùƒ ÙˆØ³Ø¹Ø±Ù‡ ÙˆØ£Ù‡Ù… Ø§Ø¹ØªØ±Ø§Ø¶ ÙŠØªÙƒØ±Ø±Ø› Ø³Ø£Ø¹Ø·ÙŠÙƒ Playbook Ù…ÙƒØ§Ù„Ù…Ø§Øª ÙˆØ±Ø³Ø§Ø¦Ù„ Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø­Ø³Ù‘Ù†Ø©.' }],
      "ÙƒÙˆØ±ØªÙƒØ³ (Cortex)": [{ role: 'ai', text: 'Ø£Ù†Ø§ ÙƒÙˆØ±ØªÙƒØ³ (Ù…Ø§Ù„ÙŠ). Ø§ÙƒØªØ¨ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª/Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© ÙˆØ§Ù„Ù‡Ø¯Ù Ø§Ù„Ø±Ø¨Ø­ÙŠØ› Ø³Ø£Ø¨Ù†ÙŠ Ù„Ùƒ Ù…ÙŠØ²Ø§Ù†ÙŠØ© ÙˆØªØªØ¨ÙÙ‘Ø¹ ØªØ¯ÙÙ‚ Ù†Ù‚Ø¯ÙŠ ÙˆÙ…Ø¤Ø´Ø±Ø§Øª.' }],
      "Ù„ÙŠÙƒØ³ (Lex)":    [{ role: 'ai', text: 'Ø£Ù†Ø§ Ù„ÙŠÙƒØ³ (Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡). ØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ÙˆÙ†ÙˆØ¹ Ø§Ù„Ù‚Ù†Ø§Ø© (ÙˆØ§ØªØ³Ø§Ø¨/Ø¨Ø±ÙŠØ¯/Ù‡Ø§ØªÙ) ÙˆØ²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©Ø› Ø³Ø£Ù‚ØªØ±Ø­ Ù‚ÙˆØ§Ù„Ø¨ ÙˆØ±Ø¯ÙˆØ¯ ÙˆØ³ÙŠØ§Ø³Ø© ØªØµØ¹ÙŠØ¯.' }],
      "Ø£ÙˆÙƒØªÙˆ (Octo)":  [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø£ÙˆÙƒØªÙˆ (Ø¹Ù…Ù„ÙŠØ§Øª). Ù…Ø§ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø±Ù‡ÙÙ‚Ø© Ø§Ù„Ø¢Ù†ØŸ Ø³Ø£Ù‚Ø¯Ù‘Ù… SOP Ù…Ø®ØªØµØ± + Ø£ØªÙ…ØªØ© Ø¨Ø£Ø¯ÙˆØ§Øª Ø¬Ø§Ù‡Ø²Ø© ÙˆØ®Ø·ÙˆØ§Øª ØªÙ†ÙÙŠØ°.' }],
      "Ù…ÙŠÙ†Ø§ (Mina)":   [{ role: 'ai', text: 'Ø£Ù†Ø§ Ù…ÙŠÙ†Ø§ (ØªØ­Ù„ÙŠÙ„Ø§Øª). Ù…Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØŸ Ø£Ø±Ø³Ù„ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙˆØ³Ø£Ø¨Ù†ÙŠ Ø£Ø³Ø¦Ù„Ø© ÙØ±Ø¶ÙŠØ© ÙˆÙ…Ù‚Ø§ÙŠÙŠØ³ Dashboard Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ°.' }],
      "Ø¨ÙˆÙ„Øª (Bolt)":   [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø¨ÙˆÙ„Øª (Ù…Ø´Ø§Ø±ÙŠØ¹). Ø§Ø°ÙƒØ± Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ ÙˆØ§Ù„Ù…ÙˆØ§Ø±Ø¯Ø› Ø³Ø£Ø®Ø±Ø¬ WBS ÙˆØ®Ø·Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© ÙˆÙ…Ø®Ø§Ø·Ø± ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªØ®ÙÙŠÙ.' }],
      "Ø±ÙŠÙƒØ³ (Rex)":    [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø±ÙŠÙƒØ³ (Ø¥Ø¯Ø§Ø±Ø© Ù…Ø§Ù„ÙŠØ© ØªØ´ØºÙŠÙ„ÙŠØ©). Ù…Ø§ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙƒÙ„ÙØ©ØŸ Ø³Ø£Ù‚ØªØ±Ø­ Ø³ÙŠØ§Ø³Ø§Øª ØµØ±Ù ÙˆØ¨Ù†ÙˆØ¯ Ø®ÙØ¶ Ø°ÙƒÙŠØ© Ø¯ÙˆÙ† Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ¯Ø©.' }],
      "Ø¨Ø§Ø¯ÙŠ (Buddy)":  [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø¨Ø§Ø¯ÙŠ (Ø¹Ù„Ø§Ù‚Ø§Øª Ø¹Ø§Ù…Ø©). Ø­Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ù„Ø¬Ù…Ù‡ÙˆØ± ÙˆØ§Ù„Ù‚Ù†Ø§Ø©Ø› Ø³Ø£Ø¨Ù†ÙŠ Ø­Ø²Ù…Ø© Ù…Ø­ØªÙˆÙ‰ ÙˆØ¬Ø¯ÙˆÙ„ Ù†Ø´Ø± ÙˆÙ†Ù…Ø§Ø°Ø¬ Ø¨ÙŠØ§Ù† ØµØ­ÙÙŠ.' }],
      "Ø±ÙˆÙØ± (Rover)":  [{ role: 'ai', text: 'Ø£Ù†Ø§ Ø±ÙˆÙØ± (CRM). Ø£Ø¹Ø·Ù†ÙŠ Ø´Ø±Ø§Ø¦Ø­Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ© ÙˆÙ‚ÙŠÙ…Ø© Ø§Ù„Ø·Ù„Ø¨Ø› Ø³Ø£ØµÙ…Ù… Ø±Ø­Ù„Ø§Øª ØªÙØ¹ÙŠÙ„/Ø§Ø­ØªÙØ§Ø¸ ÙˆØ¹Ø±ÙˆØ¶ ÙˆÙ„Ø§Ø¡.' }],
      "ÙØ§Ù„ÙˆØ± (Valor)": [{ role: 'ai', text: 'Ø£Ù†Ø§ ÙØ§Ù„ÙˆØ± (ØªØ¬Ø§Ø±Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©). Ø£Ø±Ø³Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù†ØªØ¬ ÙˆÙ†Ø³Ø¨Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠØ©Ø› Ø³Ø£Ø´Ø®Ù‘Øµ Ø§Ù„ØµÙØ­Ø© ÙˆØ£Ù‚ØªØ±Ø­ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª A/B.' }],
      "Ø²ÙŠÙ†ÙŠØ« (Zenith)":[{ role: 'ai', text: 'Ø£Ù†Ø§ Ø²ÙŠÙ†ÙŠØ« (Ø§Ø¨ØªÙƒØ§Ø±). Ø§Ø°ÙƒØ± Ø§Ù„ÙÙƒØ±Ø© ÙˆØ§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙˆØ£Ø¨Ø³Ø· MVP Ù…Ù…ÙƒÙ†Ø› Ø³Ø£Ø¨Ù†ÙŠ Canvas ÙˆØ®Ø·Ø© ØªØ­Ù‚Ù‚ Ø³Ø±ÙŠØ¹Ø©.' }]
    };

    /* ================== Gemini Bridge (Netlify) ================== */
    const NETLIFY_CHAT_ENDPOINT = "/.netlify/functions/chat";
    function currentPersona() { return typeof currentRobot === "string" ? currentRobot : ""; }

    function recentConversationFor(robotName, limit = 20) {
      const conv = safeGet(`conversation_${robotName}`, []);
      return (Array.isArray(conv) ? conv : []).slice(-limit).map(m => ({
        role: m.sender === "user" ? "user" : "assistant",
        text: m.text
      }));
    }

    function withTimeout(promise, ms = 20000) {
      const t = new Promise((_, rej) => setTimeout(() => rej(new Error("timeout")), ms));
      return Promise.race([promise, t]);
    }

    function inferIntent(text) {
      const t = text.toLowerCase();
      if (t.includes('Ø­Ù…Ù„Ø©') || t.includes('Ø§Ø¹Ù„Ø§Ù†') || t.includes('ØªØ³ÙˆÙŠÙ‚')) return 'marketing';
      if (t.includes('Ù…Ø¨ÙŠØ¹Ø§Øª') || t.includes('ØªØ­ÙˆÙŠÙ„') || t.includes('Ø¹Ù…ÙŠÙ„ Ù…Ø­ØªÙ…Ù„')) return 'sales';
      if (t.includes('Ù…ÙŠØ²Ø§Ù†ÙŠØ©') || t.includes('ØªÙƒÙ„ÙØ©') || t.includes('Ø±Ø¨Ø­') || t.includes('ØªØ¯ÙÙ‚')) return 'finance';
      if (t.includes('Ø´ÙƒÙˆÙ‰') || t.includes('ØªØ°ÙƒØ±Ø©') || t.includes('Ø±Ø¶Ø§')) return 'support';
      if (t.includes('Ù…Ø´Ø±ÙˆØ¹') || t.includes('Ù…ÙˆØ¹Ø¯') || t.includes('Ø®Ø·Ø©')) return 'pm';
      if (t.includes('ØªØ­Ù„ÙŠÙ„') || t.includes('Ø¨ÙŠØ§Ù†Ø§Øª') || t.includes('ØªÙ‚Ø±ÙŠØ±')) return 'analytics';
      if (t.includes('ÙˆÙØ§Ø¡') || t.includes('crm') || t.includes('ÙˆÙ„Ø§Ø¡')) return 'crm';
      if (t.includes('Ù…ØªØ¬Ø±') || t.includes('Ø³Ù„Ø©') || t.includes('Ù…Ù†ØªØ¬')) return 'ecom';
      if (t.includes('ÙÙƒØ±Ø©') || t.includes('mvp') || t.includes('Ø§Ø¨ØªÙƒØ§Ø±')) return 'innovation';
      return 'general';
    }

    async function geminiReply(userText, persona = "") {
      const company = safeGet("companyData", {});
      const history = recentConversationFor(currentRobot || persona);
      const body = {
        messages: [...history, { role: "user", text: userText }],
        persona,
        company,
        meta: { intent: inferIntent(userText) }
      };

      const res = await withTimeout(fetch(NETLIFY_CHAT_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      }));

      if (!res.ok) {
        const txt = await res.text();
        throw new Error(`HTTP ${res.status} - ${txt}`);
      }
      const data = await res.json();
      return (data && data.text) ? data.text : "Ù„Ù… Ø£Ø³ØªÙ‚Ø¨Ù„ Ø±Ø¯Ù‹Ø§ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬.";
    }
    function addAIMessage(text) { addMessage(robotChatMessages, text, "ai"); }

    /* --- Robot Chat Flow --- */
    function startRobotChat(robotName) {
      currentRobot = robotName;
      mainHeader.classList.add('hidden');
      scrollWrapper.classList.add('hidden');
      mainFooter.classList.add('hidden');
      robotChatInterface.style.display = 'flex';
      robotChatHeader.textContent = `Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ ${robotName}`;
      robotChatMessages.innerHTML = '';

      const savedConversation = safeGet(`conversation_${robotName}`, []);
      if (Array.isArray(savedConversation) && savedConversation.length > 0) {
        savedConversation.forEach(msg => addMessage(robotChatMessages, msg.text, msg.sender));
      } else {
        robotChatState[robotName] = 0;
        if (robotPrompts[robotName] && robotPrompts[robotName].length > 0) {
          addMessage(robotChatMessages, robotPrompts[robotName][0].text, 'ai');
        } else {
          addMessage(robotChatMessages, "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø¢Ù†. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹.", 'ai');
        }
      }
      robotChatMessages.scrollTop = robotChatMessages.scrollHeight;
    }

    backToDashboardBtn.addEventListener('click', showDashboard);
    logoutBtn.addEventListener('click', (e) => {
      e.preventDefault();
      localStorage.clear();
      window.location.reload();
    });

    fileUploadInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        addMessage(robotChatMessages, `ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ${file.name}. Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„Ù‡...`, 'user');
        setTimeout(() => {
          const aiResponse = `Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ. ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ù„Ù. Ù…Ø§ Ø³Ø¤Ø§Ù„Ùƒ Ø¨Ø®ØµÙˆØµÙ‡ØŸ`;
          addMessage(robotChatMessages, aiResponse, 'ai');
          const savedConversation = safeGet(`conversation_${currentRobot}`, []);
          savedConversation.push({ text: `ØªÙ… Ø±ÙØ¹ Ù…Ù„Ù: ${file.name}`, sender: 'user' });
          savedConversation.push({ text: aiResponse, sender: 'ai' });
          safeSet(`conversation_${currentRobot}`, savedConversation);
        }, 1200);
      }
    });

    function handleRobotChatInput() {
      const userMessage = robotChatInput.value.trim();
      if (!currentRobot) { addAIMessage("âš ï¸ Ø§Ø®ØªØ± Ù…Ø³Ø§Ø¹Ø¯Ù‹Ø§ Ø£ÙˆÙ„Ù‹Ø§ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…."); return; }
      if (userMessage === '') return;

      addMessage(robotChatMessages, userMessage, 'user');

      const savedConversation = safeGet(`conversation_${currentRobot}`, []);
      savedConversation.push({ text: userMessage, sender: 'user' });

      robotChatInput.value = '';

      (async () => {
        try {
          const reply = await geminiReply(userMessage, currentPersona());
          addAIMessage(reply);
          savedConversation.push({ text: reply, sender: 'ai' });
          safeSet(`conversation_${currentRobot}`, savedConversation);
        } catch (err) {
          console.error(err);
          const fallback = `âš ï¸ ØªØ¹Ø°Ù‘Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ:\n${err.message}`;
          addAIMessage(fallback);
          savedConversation.push({ text: fallback, sender: 'ai' });
          safeSet(`conversation_${currentRobot}`, savedConversation);
        }
      })();
    }

    robotChatSendBtn.addEventListener('click', handleRobotChatInput);
    robotChatInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleRobotChatInput(); }
    });

    document.addEventListener('DOMContentLoaded', () => {
      const robotsGrid = document.getElementById('robots-grid');
      if (robotsGrid) {
        robots.forEach(robot => {
          const div = document.createElement('div');
          div.className = 'robot-card p-4';
          div.innerHTML = `
            <div class="robot-circle"><img loading="lazy" src="${robot.img}" alt="Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø±ÙˆØ¨ÙˆØª ${robot.name}" class="robot-image"/></div>
            <h4 class="font-bold mt-4 text-white">${robot.name}</h4>
            <p class="text-sm text-gray-400 mt-2"><b>${robot.specialization}:</b> Ø¬Ø§Ù‡Ø² Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¢Ù†.</p>
          `;
          robotsGrid.appendChild(div);
        });
      }
    });

    /* ====== Mobile fixes: vh & keyboard & bottom button ====== */
    function setVH() {
      const vh = (window.visualViewport ? window.visualViewport.height : window.innerHeight) * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }
    setVH();
    window.addEventListener('resize', setVH);
    if (window.visualViewport) window.visualViewport.addEventListener('resize', setVH);

    (function fixKeyboardOverlap() {
      if (!window.visualViewport) return;
      const bars = document.querySelectorAll('.chat-input-bar');
      function sync() {
        const bottom = Math.max(0, (window.innerHeight - window.visualViewport.height - window.visualViewport.offsetTop));
        bars.forEach(el => { el.style.marginBottom = bottom ? `${bottom}px` : ''; });
      }
      window.visualViewport.addEventListener('resize', sync);
      window.visualViewport.addEventListener('scroll', sync);
      sync();
    })();

    (function enhanceChatScrollBehavior() {
      const BOT = { containers: [] };
      const robotChatMessagesEl = document.getElementById('robot-chat-messages');
      const setupChatMessagesEl = document.getElementById('setup-chat-messages');
      const scrollBtn = document.getElementById('scroll-to-bottom');

      if (robotChatMessagesEl) BOT.containers.push(robotChatMessagesEl);
      if (setupChatMessagesEl) BOT.containers.push(setupChatMessagesEl);

      function isUserAtBottom(container, threshold = 120) {
        if (!container) return true;
        return (container.scrollHeight - container.scrollTop - container.clientHeight) < threshold;
      }

      function updateScrollButtonVisibility(activeContainer) {
        if (!scrollBtn || !activeContainer) return;
        const show = !isUserAtBottom(activeContainer, 150);
        scrollBtn.classList.toggle('show', show);
      }

      function maybeAutoScroll(container) {
        if (!container) return;
        if (isUserAtBottom(container, 120)) {
          container.scrollTo({ top: container.scrollHeight, behavior: 'smooth' });
        }
      }

      function watchContainer(container) {
        if (!container) return;
        const mo = new MutationObserver((mutations) => {
          const added = mutations.some(m => m.addedNodes && m.addedNodes.length);
          if (added) { maybeAutoScroll(container); }
        });
        mo.observe(container, { childList: true, subtree: false });
      }

      BOT.containers.forEach(c => {
        c.addEventListener('scroll', () => {
          const active = BOT.containers.find(el => el && el.offsetParent !== null) || c;
          updateScrollButtonVisibility(active);
        }, { passive: true });
        watchContainer(c);
      });

      if (scrollBtn) {
        scrollBtn.addEventListener('click', () => {
          const active = BOT.containers.find(el => el && el.offsetParent !== null);
          if (active) {
            active.scrollTo({ top: active.scrollHeight, behavior: 'smooth' });
            scrollBtn.classList.remove('show');
          }
        });
      }

      const inputElements = [robotChatInput, setupChatInput].filter(Boolean);
      inputElements.forEach(inputEl => {
        inputEl.addEventListener('focus', () => {
          const activeContainer = inputEl.id === 'robot-chat-input' ? robotChatMessagesEl : setupChatMessagesEl;
          if (activeContainer) { activeContainer.scrollTo({ top: activeContainer.scrollHeight, behavior: 'smooth' }); }
        });
      });

      document.addEventListener('DOMContentLoaded', () => {
        BOT.containers.forEach(c => { try { c.scrollTop = c.scrollHeight; } catch (e) {} });
      });

      const originalAddMessage = window.addMessage;
      window.addMessage = function(chatContainer, text, sender) {
        originalAddMessage(chatContainer, text, sender);
        maybeAutoScroll(chatContainer);
        updateScrollButtonVisibility(chatContainer);
      };
    })();
  </script>

  <!-- ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø³Ø± Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· -->
  <script src="auth-bridge-global.js"></script>

  <!-- Patch Add-on: ØªÙ…Ø±ÙŠØ± meta.lang + Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª + Ø­ÙØ¸ Ø§Ù„Ø°Ø§ÙƒØ±Ø© -->
  <script>
  (() => {
    const NETLIFY_CHAT_ENDPOINT = "/.netlify/functions/chat";

    async function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        try {
          const reader = new FileReader();
          reader.onload = () => {
            const res = String(reader.result || "");
            const base64 = res.includes(",") ? res.split(",")[1] : res;
            resolve({ base64, mime: file.type || "application/octet-stream", name: file.name || "file" });
          };
          reader.onerror = reject;
          reader.readAsDataURL(file);
        } catch (e) { reject(e); }
      });
    }

    function withTimeout(promise, ms = 20000) {
      const t = new Promise((_, rej) => setTimeout(() => rej(new Error("timeout")), ms));
      return Promise.race([promise, t]);
    }

    const getPersona = () => (typeof window.currentPersona === "function" ? window.currentPersona() : (window.currentRobot || ""));
    const getHistory = (persona) => (typeof window.recentConversationFor === "function"
      ? window.recentConversationFor(window.currentRobot || persona)
      : []);

    try { window.__origGeminiReply = window.geminiReply; } catch {}

    // override Ø¢Ù…Ù† Ù…Ø¹ Ù„ØºØ© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
    async function geminiReply_v2(userText, persona = "", files = []) {
      const company = safeGet("companyData", {});
      const history = getHistory(persona);
      const langFromDom = (document.documentElement && document.documentElement.lang ? document.documentElement.lang : "").slice(0,2).toLowerCase();
      const lang = (langFromDom === "ar" || langFromDom === "en")
        ? langFromDom
        : ((navigator.language || "ar").slice(0,2).toLowerCase());

      const body = {
        messages: [...history, { role: "user", text: userText }],
        persona,
        company,
        meta: {
          intent: (typeof window.inferIntent === "function" ? window.inferIntent(userText) : "general"),
          lang
        },
        files: Array.isArray(files) ? files.map(f => ({ mime: f.mime, base64: f.base64 })) : []
      };

      const res = await withTimeout(fetch(NETLIFY_CHAT_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body)
      }));

      if (!res.ok) {
        const txt = await res.text().catch(() => "");
        throw new Error(`HTTP ${res.status} - ${txt || "request failed"}`);
      }

      const data = await res.json().catch(() => ({}));

      if (data && data.memoryPatch && typeof data.memoryPatch === "object") {
        try {
          const prev = safeGet("aiLearnedData", {});
          const next = { ...prev, ...data.memoryPatch };
          safeSet("aiLearnedData", next);
        } catch {}
      }
      return (data && data.text) ? data.text : (lang === "ar" ? "Ù„Ù… Ø£Ø³ØªÙ‚Ø¨Ù„ Ø±Ø¯Ù‹Ø§ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬." : "No response from the model.");
    }

    window.geminiReply = geminiReply_v2;

    const fileInput = document.getElementById("file-upload");
    if (fileInput) {
      fileInput.addEventListener("change", async (e) => {
        const file = e.target.files && e.target.files[0];
        if (!file) return;

        const personaName = getPersona();
        const chatContainer = document.getElementById("robot-chat-messages");
        const userMsg = `ØªÙ… Ø±ÙØ¹ "${file.name}" â€” Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...`;
        if (typeof window.addMessage === "function") window.addMessage(chatContainer, userMsg, "user");

        const convKey = `conversation_${window.currentRobot}`;
        const saved = safeGet(convKey, []);
        saved.push({ text: userMsg, sender: "user" });

        try {
          const f = await fileToBase64(file);
          const aiReply = await window.geminiReply("Ø­Ù„Ù‘Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù ÙˆÙ‚Ø¯Ù‘Ù… ØªÙˆØµÙŠØ§Øª Ø¹Ù…Ù„ÙŠØ© Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª/Ø®Ø·ÙˆØ§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙ†ÙÙŠØ°.", personaName, [f]);
          if (typeof window.addMessage === "function") window.addMessage(chatContainer, aiReply, "ai");
          saved.push({ text: aiReply, sender: "ai" });
          safeSet(convKey, saved);
        } catch (err) {
          const fail = `âš ï¸ ØªØ¹Ø°Ù‘Ø± Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù: ${err && err.message ? err.message : err}`;
          if (typeof window.addMessage === "function") window.addMessage(chatContainer, fail, "ai");
          saved.push({ text: fail, sender: "ai" });
          safeSet(convKey, saved);
        }
        e.target.value = '';
      });
    }
  })();
  </script>

  <!-- (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·) -->
  <script src="auth-bridge-global.js"></script>
</body>
</html>
