<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù†</title>
  <style>
    body {
      font-family: "Tajawal", sans-serif;
      background: #111827;
      color: #f9fafb;
      margin: 0; padding: 0;
    }
    header {
      padding: 1rem;
      background: #1f2937;
      text-align: center;
    }
    .hidden { display: none !important; }
    .container { padding: 1rem 2rem; }

    /* ØµÙ†Ø¯ÙˆÙ‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
    #login-box {
      max-width: 400px;
      margin: 3rem auto;
      padding: 2rem;
      background: #1f2937;
      border-radius: 8px;
      text-align: center;
    }
    #login-box input {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.5rem;
      border-radius: 4px;
      border: none;
    }
    #login-box button {
      padding: 0.5rem 1rem;
      border: none;
      background: #2563eb;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }

    /* Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† */
    table {
      width: 100%;
      margin-top: 1rem;
      border-collapse: collapse;
      background: #1f2937;
    }
    th, td {
      padding: 0.75rem;
      border-bottom: 1px solid #374151;
    }
    th {
      background: #111827;
      text-align: left;
    }

    /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ */
    #modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #modal-content {
      background: #1f2937;
      padding: 2rem;
      border-radius: 8px;
      width: 90%; max-width: 500px;
    }
    #modal-content input {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.5rem;
      border-radius: 4px;
      border: none;
    }
    #modal-content button {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 4px;
      margin-left: 0.5rem;
      cursor: pointer;
    }
    .btn-primary { background: #2563eb; color: #fff; }
    .btn-danger { background: #dc2626; color: #fff; }
  </style>
</head>
<body>
  <header>
    <h1>Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ø¯Ù…Ù† â€” Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h1>
  </header>

  <!-- ØµÙ†Ø¯ÙˆÙ‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
  <div id="login-box">
    <h2>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
    <input type="text" id="admin-user" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    <input type="password" id="admin-pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
    <button id="login-btn">Ø¯Ø®ÙˆÙ„</button>
    <p id="login-msg" style="color:red; margin-top:10px;"></p>
  </div>

  <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø£Ø¯Ù…Ù† -->
  <div id="admin-panel" class="hidden container">
    <button id="add-user-btn" class="btn-primary">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</button>
    <table id="users-table">
      <thead>
        <tr>
          <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
          <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
          <th>Ø§Ù„Ø¯ÙˆØ±</th>
          <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ -->
  <div id="modal" class="hidden">
    <div id="modal-content">
      <h3 id="modal-title">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</h3>
      <input type="text" id="m_username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
      <input type="email" id="m_email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯">
      <input type="password" id="m_pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
      <input type="text" id="m_role" placeholder="Ø§Ù„Ø¯ÙˆØ± (Ù…Ø«Ø§Ù„: Ù…Ø³ØªØ®Ø¯Ù…)">
      <div style="text-align: right;">
        <button id="save-user" class="btn-primary">Ø­ÙØ¸</button>
        <button id="cancel-user" class="btn-danger">Ø¥Ù„ØºØ§Ø¡</button>
      </div>
    </div>
  </div>

  <script>
    // ---- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ----
    const ADMIN_USERNAME = "admin";
    const ADMIN_PASSWORD = "Admin@2025";

    const loginBox   = document.getElementById("login-box");
    const adminPanel = document.getElementById("admin-panel");
    const loginBtn   = document.getElementById("login-btn");
    const loginMsg   = document.getElementById("login-msg");

    loginBtn.addEventListener("click", () => {
      const u = document.getElementById("admin-user").value.trim();
      const p = document.getElementById("admin-pass").value;
      if (u === ADMIN_USERNAME && p === ADMIN_PASSWORD) {
        loginBox.classList.add("hidden");
        adminPanel.classList.remove("hidden");
        renderUsers();
      } else {
        loginMsg.textContent = "âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
      }
    });

    // ---- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ----
    let editingIndex = null;
    const modal      = document.getElementById("modal");
    const addBtn     = document.getElementById("add-user-btn");
    const saveBtn    = document.getElementById("save-user");
    const cancelBtn  = document.getElementById("cancel-user");
    const tableBody  = document.querySelector("#users-table tbody");

    function getUsers() {
      return JSON.parse(localStorage.getItem("app_users") || "[]");
    }
    function setUsers(users) {
      localStorage.setItem("app_users", JSON.stringify(users));
    }

    function renderUsers() {
      const users = getUsers();
      tableBody.innerHTML = "";
      users.forEach((user, i) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${user.username}</td>
          <td>${user.email || ""}</td>
          <td>${user.role || "Ù…Ø³ØªØ®Ø¯Ù…"}</td>
          <td>
            <button onclick="editUser(${i})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
            <button onclick="deleteUser(${i})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
          </td>
        `;
        tableBody.appendChild(tr);
      });
    }

    addBtn.addEventListener("click", () => {
      editingIndex = null;
      document.getElementById("modal-title").textContent = "Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…";
      document.getElementById("m_username").value = "";
      document.getElementById("m_email").value = "";
      document.getElementById("m_pass").value = "";
      document.getElementById("m_role").value = "Ù…Ø³ØªØ®Ø¯Ù…";
      modal.classList.remove("hidden");
    });

    cancelBtn.addEventListener("click", () => modal.classList.add("hidden"));

    saveBtn.addEventListener("click", () => {
      const username = document.getElementById("m_username").value.trim();
      const email    = document.getElementById("m_email").value.trim();
      const pass     = document.getElementById("m_pass").value;
      const role     = document.getElementById("m_role").value.trim() || "Ù…Ø³ØªØ®Ø¯Ù…";

      if (!username || !pass) {
        alert("âš ï¸ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±");
        return;
      }

      const users = getUsers();
      if (editingIndex !== null) {
        users[editingIndex] = { username, email, pass, role };
      } else {
        users.push({ username, email, pass, role });
      }
      setUsers(users);
      modal.classList.add("hidden");
      renderUsers();
    });

    // ---- Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù ----
    window.editUser = function(i) {
      editingIndex = i;
      const user = getUsers()[i];
      document.getElementById("modal-title").textContent = "ØªØ¹Ø¯ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…";
      document.getElementById("m_username").value = user.username;
      document.getElementById("m_email").value    = user.email;
      document.getElementById("m_pass").value     = user.pass;
      document.getElementById("m_role").value     = user.role;
      modal.classList.remove("hidden");
    }

    window.deleteUser = function(i) {
      if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ")) return;
      const users = getUsers();
      users.splice(i, 1);
      setUsers(users);
      renderUsers();
    }
  </script>
</body>
</html>
